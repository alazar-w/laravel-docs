<!DOCTYPE html>
<!-- saved from url=(0036)https://laravel.com/docs/6.0/billing -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>Laravel Cashier - Laravel - The PHP Framework For Web Artisans</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://laravel.com/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://laravel.com/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://laravel.com/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://laravel.com/img/favicon/site.webmanifest">
    <link rel="mask-icon" href="https://laravel.com/img/favicon/safari-pinned-tab.svg" color="#ff2d20">
    <link rel="shortcut icon" href="https://laravel.com/img/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#ff2d20">
    <meta name="msapplication-config" content="/img/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- Load fonts -->
    <link rel="stylesheet" href="./01-Cashier_files/ins2wgm.css">

    <!-- Load styles -->
    <link rel="stylesheet" type="text/css" href="./01-Cashier_files/app.css">

    <!-- Load JS -->
    <script src="./01-Cashier_files/ga.js.download"></script><script src="./01-Cashier_files/jquery.min.js.download"></script>

<style type="text/css">:root topadblock, :root input[onclick^="window.open('http://www.FriendlyDuck.com/"], :root img[alt^="Fuckbook"], :root iframe[src^="http://static.mozo.com.au/strips/"], :root iframe[src^="http://cdn2.adexprt.com/"], :root iframe[id^="google_ads_iframe"], :root header#hdr + #main > div[data-hveid], :root div[id^="zergnet-widget"], :root div[id^="mainads"], :root div[id^="dmRosAdWrapper"], :root a[href^="http://at.atwola.com/"], :root a[onmousedown^="this.href='https://paid.outbrain.com/network/redir?"][target="_blank"] + .ob_source, :root div[id^="div-ads-"], :root a[data-obtrack^="http://paid.outbrain.com/network/redir?"], :root a[href^="http://www1.clickdownloader.com/"], :root div[id^="cns_ads_"], :root #\5f _admvnlb_modal_container, :root div[id^="adspot-"], :root a[href^="https://trust.zone/go/r.php?RID="], :root div[id^="tms-ad-dfp-"], :root input[onclick^="window.open('http://www.friendlyduck.com/"], :root div[id^="ads300_250-widget"], :root div[id^="ads250_250-widget"], :root div[id^="adrotate_widgets-"], :root div[id^="adfox_"], :root div[id^="ad_script_"], :root #content > #right > .dose > .dosesingle, :root div[id^="ad_bigbox_"], :root div[id^="ad-server-"], :root div[id^="acm-ad-tag-"], :root div[id^="ADV-SLOT-"], :root div[data-native_ad], :root a[href^=" http://n47adshostnet.com/"], :root div[data-id^="CarouselPLA-"] > .kzwEHf, :root div[class^="proadszone-"], :root div[class^="pane-google-admanager-"], :root a[href^="http://adultgames.xxx/"], :root a[href^="http://semi-cod.com/clicks/"], :root div[class^="index_displayAd_"], :root a[href^="http://www.affbuzzads.com/affiliate/"], :root div[class^="index_adBeforeContent_"], :root div[class^="index_adAfterContent_"], :root div[class^="block-openx-"], :root div[class^="ads-partner-"], :root div[class^="ad_position_"], :root div[class^="ad_border_"], :root a[href^="http://adprovider.adlure.net/"], :root div[class^="Ad__container"], :root div[id^="div-adtech-ad-"], :root div[class*="_AdInArticle_"], :root div > [class][onclick*=".updateAnalyticsEvents"], :root a[href^="http://internalredirect.site/"], :root bottomadblock, :root a[href^="https://watchmygirlfriend.tv/"], :root a[href^="http://2pxg8bcf.top/"], :root aside[itemtype="https://schema.org/WPAdBlock"], :root a[href^="http://c.actiondesk.com/"], :root aside[id^="div-gpt-ad"], :root div[id^="ad-cid-"], :root a[href^="http://lp.ezdownloadpro.info/"], :root a[href^="http://uploaded.net/ref/"], :root aside[id^="advads_ad_widget-"], :root aside[id^="adrotate_widgets-"], :root a[target="_blank"][href^="http://api.taboola.com/"], :root a[style="display:block;width:300px;min-height:250px"][href^="http://li.cnet.com/click?"], :root a[onmousedown^="this.href='http://paid.outbrain.com/network/redir?"][target="_blank"] + .ob_source, :root a[href^="http://popup.taboola.com/"], :root a[href^="//adbit.co/?a=Advertise&"], :root a[onmousedown^="this.href='/wp-content/embed-ad-content/"], :root div[class^="AdhesionAd_"], :root div[class^="Ad__bigBox"], :root div[role="navigation"] + c-wiz > script + div > .kxhcC, :root a[onclick*="//m.economictimes.com/etmack/click.htm"], :root a[href^="https://www.what-sexdating.com/"], :root a[href^="https://www.travelzoo.com/oascampaignclick/"], :root a[href^="https://www.share-online.biz/affiliate/"], :root a[href^="https://www.securegfm.com/"], :root div[id^="advads_"], :root a[href^="https://www.moscarossa.biz/"], :root a[href^="http://www.usearchmedia.com/signup?"], :root a[onmousedown^="this.href='http://staffpicks.outbrain.com/network/redir?"][target="_blank"] + .ob_source, :root a[href^="https://www.incontri-matura.com/"], :root a[href^="https://www.goldenfrog.com/vyprvpn?offer_id="][href*="&aff_id="], :root .trc_related_container div[data-item-syndicated="true"], :root a[href^="https://www.firstload.com/affiliate/"], :root a[href^="https://www.camyou.com/?cam="][href*="&track="], :root a[href^="https://www.bebi.com"], :root a[href^="https://www.adskeeper.co.uk/"], :root a[href^="http://pan.adraccoon.com?"], :root div[id^="ad-gpt-"], :root a[href^="http://farm.plista.com/pets"], :root a[href^="https://windscribe.com/promo/"], :root a[href^="http://serve.williamhill.com/promoRedirect?"], :root a[href^="https://vodexor.us/"], :root a[href^="https://track.adform.net/"], :root a[href^="https://traffic.bannerator.com/"], :root a[href^="https://tracking.truthfinder.com/?a="], :root a[href^="https://www.adultempire.com/"][href*="?partner_id="], :root a[href^="https://track.healthtrader.com/"], :root a[href^="https://track.clickmoi.xyz/"], :root a[href^="https://track.afftck.com/"], :root a[href^="https://control.trafficfabrik.com/"], :root a[href^="https://track.52zxzh.com/"], :root div[class^="gemini-ad"], :root a[href^="http://pwrads.net/"], :root a[href^="//oardilin.com/"], :root a[href^="http://gca.sh/user/register?ref="], :root a[href^="https://torguard.net/aff.php"], :root a[href^="http://tour.affbuzzads.com/"], :root a[href^="https://tc.tradetracker.net/"], :root a[href^="https://t.mobtya.com/"], :root a[href^="https://t.grtyi.com/"], :root aside[id^="tn_ads_widget-"], :root a[href^="https://syndication.exoclick.com/splash.php?"], :root a[href^="http://click.guamwnvgashbkashawhgkhahshmashcas.pw/"], :root div[id^="YFBMSN"], :root div[id^="ad-div-"], :root a[href^="https://secure.eveonline.com/ft/?aid="], :root a[href^="https://rev.adsession.com/"], :root a[href^="https://retiremely.com/"], :root div[id^="yandex_ad"], :root a[href^="http://y1jxiqds7v.com/"], :root a[href^="https://www.pornhat.com/"][rel="nofollow"], :root AD-SLOT, :root a[href^="http://green.trafficinvest.com/"], :root a[href^="https://pubads.g.doubleclick.net/"], :root a[href^="https://prf.hn/click/"][href*="/adref:"], :root a[href^="https://mk-cdn.net/"], :root div[id^="proadszone-"], :root a[href^="https://mk-ads.com/"], :root a[href^="https://jmp.awempire.com/"], :root a[href^="https://members.linkifier.com/public/affiliateLanding?refCode="], :root a[href^="https://medleyads.com/"], :root div[id^="ads300_100-widget"], :root a[href^="https://click.plista.com/pets"], :root a[href^="https://lingthatsparleso.info/"], :root a[href^="https://laptop-updates.brave.com/download/"], :root a[href*=".approvallamp.club/"], :root a[href^="https://landing1.brazzersnetwork.com"], :root a[href^="https://land.rk.com/landing/"], :root .lads[width="100%"][style="background:#FFF8DD"], :root a[href^="https://land.brazzersnetwork.com/landing/"], :root a[href^="https://incisivetrk.cvtr.io/click?"], :root a[href^="https://iactrivago.ampxdirect.com/"], :root a[href^="https://googleads.g.doubleclick.net/pcs/click"], :root a[href^="http://cdn.adstract.com/"], :root a[href^="https://gogoman.me/"], :root a[href^="https://go.stripchat.com/"][href*="&campaignId="], :root a[href*=".inclk.com/"], :root a[href^="https://go.ad2up.com/"], :root a[href^="https://freeadult.games/"], :root a[href^="//nlkdom.com/"], :root a[onmousedown^="this.href='http://staffpicks.outbrain.com/network/redir?"][target="_blank"], :root a[href^="https://fonts.fontplace9.com/"], :root a[href^="http://clkmon.com/adServe/"], :root a[href^="https://flirtaescopa.com/"], :root a[href^="https://farm.plista.com/pets"], :root a[href^="https://evaporate.pw/"], :root a[href^="http://wxdownloadmanager.com/dl/"], :root div[class^="local-feed-banner-ads"], :root .GFYY1SVE2 > .GFYY1SVD2 > .GFYY1SVG5, :root a[href^="https://djtcollectorclub.org/"][href*="?affiliate_id="], :root a[href^="https://chaturbate.xyz/"], :root a[href^="https://chaturbate.jjgirls.com/"][href*="?tour="], :root a[href^="https://chaturbate.com/in/?tour="], :root a[href^="https://chaturbate.com/affiliates/"], :root a[href^="http://www.1clickdownloader.com/"], :root a[href^="https://www.googleadservices.com/pagead/aclk?"], :root a[href^="https://awentw.com/"], :root a[href^="https://servedbyadbutler.com/"], :root a[href^="http://dethao.com/"], :root a[href^="https://ads.ad4game.com/"], :root a[href^="https://betway.com/"][href*="&a="], :root a[href^="https://affiliates.bet-at-home.com/processing/"], :root a[href*="pussl3.com"], :root a[href^="https://adswick.com/"], :root ADS-RIGHT, :root .GKJYXHBF2 > .GKJYXHBE2 > .GKJYXHBH5, :root a[href^="https://adserver.adreactor.com/"], :root a[href^="https://refpaano.host/"], :root a[href^="http://data.linoleictanzaniatitanic.com/"], :root a[href^="https://adhealers.com/"], :root a[href^="https://adclick.g.doubleclick.net/"], :root a[href^="https://ad.doubleclick.net/"], :root a[href^="http://zevera.com/afi.html"], :root a[href^="http://go.oclaserver.com/"], :root a[href^="https://ad.atdmt.com/"], :root .trc_rbox .syndicatedItem, :root a[href^="https://aaucwbe.com/"], :root a[href^="https://a.adtng.com/"], :root a[href^="http://xtgem.com/click?"], :root a[href^="https://ads.trafficpoizon.com/"], :root a[href^="http://rekoverr.com/"], :root a[href^="https://chaturbate.com/in/?track="], :root a[href^="http://www.zergnet.com/i/"], :root a[href^="http://hyperies.info/"], :root a[href^="http://galleries.pinballpublishernetwork.com/"], :root a[href^="http://www.torntv-downloader.com/"], :root a[href^="http://www.tirerack.com/affiliates/"], :root a[href^="http://www.text-link-ads.com/"], :root a[href^="http://www.friendlyquacks.com/"], :root div[id^="div_openx_ad_"], :root a[href^="http://www.streamate.com/exports/"], :root a[onmousedown^="this.href='https://paid.outbrain.com/network/redir?"][target="_blank"], :root a[href^="http://www.sfippa.com/"], :root a[href^="http://www.xmediaserve.com/"], :root a[href^="http://www.sex.com/videos/?utm_"], :root a[href^="http://paid.outbrain.com/network/redir?"], :root a[href^="http://www.sex.com/?utm_"], :root a[onmousedown^="this.href='http://paid.outbrain.com/network/redir?"][target="_blank"], :root a[href^="http://www.roboform.com/php/land.php"], :root a[href^="http://www.myfreecams.com/?co_id="][href*="&track="], :root div[id^="advads-"], :root a[href^="https://k2s.cc/pr/"], :root a[href^="http://ad.au.doubleclick.net/"], :root a[href^="http://www.ringtonematcher.com/"], :root a[href^="http://secure.signup-page.com/"], :root a[href^="http://www.quick-torrent.com/download.html?aff"], :root a[href^="http://adexprt.me/"], :root a[href^="http://www.pinkvisualgames.com/?revid="], :root a[href^="https://trklvs.com/"], :root a[href^="http://www.paddypower.com/?AFF_ID="], :root div[data-spotim-slot], :root a[href^="http://www.freefilesdownloader.com/"], :root a[href^="http://www.mysuperpharm.com/"], :root .trc_rbox_border_elm .syndicatedItem, :root a[href^="http://www.myfreepaysite.com/sfw_int.php?aid"], :root a[href^="http://www.myfreepaysite.com/sfw.php?aid"], :root .rhsvw[style="background-color:#fff;margin:0 0 14px;padding-bottom:1px;padding-top:1px;"], :root a[href^="http://www.moneyducks.com/"], :root a[href^="http://bcntrack.com/"], :root a[href^="http://www.securegfm.com/"], :root a[href^="http://www.liversely.net/"], :root a[href^="http://www.linkbucks.com/referral/"], :root a[href^="//88d7b6aa44fb8eb.com/"], :root a[href^="http://www.ireel.com/signup?ref"], :root a[href*="=Adtracker"], :root a[href^="http://www.incredimail.com/?id="], :root a[href^="http://www.idownloadplay.com/"], :root a[href^="http://www.hitcpm.com/"], :root a[href^="http://www.greenmangaming.com/?tap_a="], :root a[href^="http://www.gamebookers.com/cgi-bin/intro.cgi?"], :root a[href^="https://www.financeads.net/tc.php?"], :root a[href^="http://www.friendlyduck.com/AF_"], :root a[href*="emprestimo.eu"], :root a[href^="http://www.fpcTraffic2.com/blind/in.cgi?"], :root a[href^="http://www.fonts.com/BannerScript/"], :root a[href^="http://www.fleshlight.com/"], :root a[href^="http://www.flashx.tv/downloadthis"], :root .trc_rbox_div a[target="_blank"][href^="http://tab"], :root a[href^="https://americafirstpolls.com/"], :root a[href^="http://clickserv.sitescout.com/"], :root a[href^="http://www.firstload.de/affiliate/"], :root a[href^="http://www.twinplan.com/AF_"], :root a[href^="http://www.fducks.com/"], :root a[href^="http://marketgid.com"], :root a[href^="http://www.faceporn.net/free?"], :root a[href^="http://www.epicgameads.com/"], :root a[href^="http://www.easydownloadnow.com/"], :root a[href^="http://www.duckssolutions.com/"], :root a[href^="https://go.trkclick2.com/"], :root a[href^="http://www.duckcash.eu/"], :root a[href^="http://www.drowle.com/"], :root a[href^="http://go.seomojo.com/tracking202/"], :root a[href^="http://www.downloadweb.org/"], :root .commercial-unit-mobile-top .jackpot-main-content-container > .UpgKEd + .nZZLFc > .vci, :root a[href^="http://www.installads.net/"], :root div[role="navigation"] + c-wiz > div > .kxhcC, :root a[href^="http://www.download-provider.org/"], :root a[href^="http://www.down1oads.com/"], :root a[href^="https://trafficmedia.center/"], :root a[href^="http://www.dealcent.com/register.php?affid="], :root .rscontainer > .ellip, :root a[href^="http://www.clkads.com/adServe/"], :root a[href^="http://www.clickansave.net/"], :root div[class^="adpubs-"], :root a[href*="deliver.trafficfabrik.com"], :root a[href^="http://www.cash-duck.com/"], :root a[href^="http://www.bitlord.me/share/"], :root a[href^="http://www.bet365.com/"][href*="?affiliate="], :root a[href^="http://www.bet365.com/"][href*="&affiliate="], :root a[href^="http://www.badoink.com/go.php?"], :root #mbEnd[cellspacing="0"][cellpadding="0"], :root div[data-ad-underplayer], :root a[href^="http://www.richducks.com/"], :root a[href^="http://www.babylon.com/welcome/index?affID"], :root a[href^="http://www.sexgangsters.com/?pid="], :root a[href^="http://www.amazon.co.uk/exec/obidos/external-search?"], :root a[href^="https://ads-for-free.com/click.php?"], :root a[href^="http://tracker.mybroadband.co.za/"], :root a[href^="http://www.socialsex.com/"], :root a[href^="https://www.camsoda.com/enter.php?id="], :root a[href^="http://www.afco2go.com/srv.php?"], :root a[href^="http://go.ad2up.com/"], :root a[href^="https://badoinkvr.com/"], :root a[href*="/adServe/banners?"], :root a[href^="http://www.adxpansion.com"], :root a[href^="http://www.ragazzeinvendita.com/?rcid="], :root .plistaList > .itemLinkPET, :root a[href^="http://ads.pheedo.com/"], :root a[href^="http://www.adbrite.com/mb/commerce/purchase_form.php?"], :root a[href^="http://www.TwinPlan.com/AF_"], :root #rhs_block .mod > .gws-local-hotels__booking-module, :root a[href^="http://www.my-dirty-hobby.com/?sub="], :root a[href^="https://porndeals.com/?track="], :root a[href^="http://www.affiliates1128.com/processing/"], :root a[href^="http://c.jumia.io/"], :root a[href^="http://www.1clickmoviedownloader.info/"], :root div[class^="adbanner_"], :root a[href^="http://www.brightwheel.info/"], :root a[href^="http://www.123-reg.co.uk/affiliate2.cgi"], :root div[id^="lazyad-"], :root div[itemtype="http://www.schema.org/WPAdBlock"], :root a[href^="http://wopertific.info/"], :root a[href^="http://bodelen.com/"], :root a[href^="http://wgpartner.com/"], :root a[href^="http://webgirlz.online/landing/"], :root div[id^="ads300_600-widget"], :root div[class^="Ad__adContainer"], :root a[href^="http://web.adblade.com/"], :root div[class^="BlockAdvert-"], :root a[href^="https://go.onclasrv.com/"], :root a[href^="http://wct.link/"], :root a[href^="http://s9kkremkr0.com/"], :root a[href^="https://www.nutaku.net/signup/landing/"], :root a[href^="http://us.marketgid.com"], :root a[href^="http://ul.to/ref/"], :root a[href^="http://trk.mdrtrck.com/"], :root a[href*=".ichlnk.com/"], :root div[id^="div_ad_stack_"], :root a[href^="http://traffic.tc-clicks.com/"], :root div[class^="awpcp-random-ads"], :root a[href^="http://www.graboid.com/affiliates/"], :root a[href^="http://tracking.toroadvertising.com/"], :root a[href^="http://www.liutilities.com/"], :root a[href^="http://www.dl-provider.com/search/"], :root a[href^="http://tracking.deltamediallc.com/"], :root a[href^="http://adultfriendfinder.com/p/register.cgi?pid="], :root a[href^="https://www.popads.net/users/"], :root iframe[src^="http://ad.yieldmanager.com/"], :root a[href^="http://pubads.g.doubleclick.net/"], :root a[href^="https://sexdatingz.live/"], :root a[href^="//bwnjijl7w.com/"], :root a[href^="https://adultfriendfinder.com/go/page/landing"], :root a[href^="http://tracking.crazylead.com/"], :root a[href^="http://track.adform.net/"], :root a[href^="https://iac.ampxdirect.com/"], :root a[href^="http://t.mdn2015x3.com/"], :root a[href^="http://steel.starflavor.bid/"], :root a[href^="http://galleries.securewebsiteaccess.com/"], :root a[href^="http://stateresolver.link/"], :root a[href^="http://sharesuper.info/"], :root a[href^="http://server.cpmstar.com/click.aspx?poolid="], :root a[href^="http://www.downloadthesefiles.com/"], :root a[href^="http://secure.cbdpure.com/aff/"], :root a[href^="http://t.mdn2015x1.com/"], :root a[href^="http://azmobilestore.co/"], :root a[href^="http://s5prou7ulr.com/"], :root a[href*="/cmd.php?ad="], :root a[href^="http://refpaano.host/"], :root #\5f _mom_ad_2, :root a[href^="http://ads.sprintrade.com/"], :root a[href^="http://record.commissionking.com/"], :root div[class*="-storyBodyAd-"], :root a[href^="http://record.betsafe.com/"], :root a[href^="https://keep2share.cc/pr/"], :root a[href^="https://clixtrac.com/"], :root [onclick*="content.ad/"], :root a[href^="http://adlev.neodatagroup.com/"], :root a[href^="http://reallygoodlink.extremefreegames.com/"], :root .ob_container .item-container-obpd, :root a[href^="http://www.adskeeper.co.uk/"], :root a[href^="http://websitedhoome.com/"], :root a[href^="http://see-work.info/"], :root a[href^="http://prousa.work/"], :root a[href^="http://promos.bwin.com/"], :root a[href^="http://prochina.link/"], :root a[href*=".irtyc.com/"], :root a[href^="http://z1.zedo.com/"], :root a[href^="http://pokershibes.com/index.php?ref="], :root #rhs_block .mod > .luhb-div > div[data-async-type="updateHotelBookingModule"], :root a[href^="http://mojofun.info/"], :root a[href^="http://mmo123.co/"], :root a[href^="http://media.paddypower.com/redirect.aspx?"], :root a[href*=".qertewrt.com/"], :root a[href^="//pubads.g.doubleclick.net/"], :root a[href^="http://lp.ncdownloader.com/"], :root #rhs_block .xpdopen > ._OKe > div > .mod > ._yYf, :root a[href^="//ads.ad-center.com/"], :root a[href^="https://track.trkinator.com/"], :root a[data-redirect^="this.href='http://paid.outbrain.com/network/redir?"], :root div[id^="ad-position-"], :root a[href^="http://liversely.com/"], :root a[href^="https://www.arthrozene.com/"][href*="?tid="], :root a[href^="http://feeds1.validclick.com/"], :root a[href^="http://latestdownloads.net/download.php?"], :root a[href^="http://k2s.cc/code/"], :root #topstuff > #tads, :root a[href^="https://atomidownload.com/"], :root a[href*=".bang.com/"][href*="&aff="], :root a[data-widget-outbrain-redirect^="http://paid.outbrain.com/network/redir?"], :root a[href^="http://join3.bannedsextapes.com/track/"], :root a[href^="https://secure.bstlnk.com/"], :root a[href^="http://jobitem.org/"], :root a[href^="https://gamescarousel.com/"], :root a[href^="http://istri.it/?"], :root a[href^="http://www.fbooksluts.com/"], :root a[href^="http://www.cdjapan.co.jp/aff/click.cgi/"], :root a[href^="//api.ad-goi.com/"], :root a[href*="//ridingintractable.com/"], :root a[href^="http://intent.bingads.com/"], :root div[id^="crt-"][style], :root a[href^="http://igromir.info/"], :root a[href^="https://track.themadtrcker.com/"], :root a[href^="http://hyperlinksecure.com/go/"], :root a[href^="http://45eijvhgj2.com/"], :root a[href^="http://hpn.houzz.com/"], :root a[href^="http://searchtabnew.com/"], :root a[href*="?adlivk="][href*="&refer="], :root a[href^="//look.djfiln.com/"], :root a[href^="http://greensmoke.com/"], :root a[href^="https://bnsjb1ab1e.com/"], :root a[href^="http://mo8mwxi1.com/"], :root div[class^="ResponsiveAd-"], :root a[href^="http://install.securewebsiteaccess.com/"], :root a[href^="http://www.revenuehits.com/"], :root div[id^="block-views-topheader-ad-block-"], :root a[href^="https://bs.serving-sys.com"], :root .__y_elastic .__y_item, :root a[href^="http://go.mobisla.com/"], :root a[href^="//srv.buysellads.com/"], :root a[href^="http://g1.v.fwmrm.net/ad/"], :root .widget-pane-section-result[data-result-ad-type], :root a[href^="http://imads.integral-marketing.com/"], :root a[href^="http://freesoftwarelive.com/"], :root a[href^="http://adtrackone.eu/"], :root a[href^="http://finaljuyu.com/"], :root a[href^="https://paid.outbrain.com/network/redir?"], :root a[href^="http://fileupnow.rocks/"], :root a[href^="http://fileloadr.com/"], :root a[href^="https://dltags.com/"], :root a[href^="http://onclickads.net/"], :root a[href^="https://gghf.mobi/"], :root a[href^="http://www.terraclicks.com/"], :root a[href^="http://www.coinducks.com/"], :root a[href^="http://extra.bet365.com/"][href*="?affiliate="], :root a[href^="http://ethfw0370q.com/"], :root [id^="bunyad_ads_"], :root a[href^="http://elitefuckbook.com/"], :root a[href^="https://www.brazzersnetwork.com/landing/"], :root #cnt #center_col > #taw > #tvcap > .c._oc._Lp, :root [href*="//xml.revrtb.com/"], :root a[href^="http://elite-sex-finder.com/?"], :root a[href^="http://eclkmpsa.com/"], :root a[href*="//3wr110.xyz/"], :root a[href^="http://earandmarketing.com/"], :root a[href^="https://www.mypornstarcams.com/landing/click/"], :root a[href*=".intab.fun/"], :root a[href^="http://secure.signup-way.com/"], :root [href^="https://maskip.co/"], :root a[href^="http://getlinksinaseconds.com/"], :root #content > #center > .dose > .dosesingle, :root a[href^="http://campaign.bharatmatrimony.com/track/"], :root a[href^="http://d2.zedo.com/"], :root a[href^="http://keep2share.cc/pr/"], :root a[href^="http://cp.cbbp1.com"], :root a[href^="http://contractallsticker.net/"], :root a[href^="http://codec.codecm.com/"], :root div[id^="google_dfp_"], :root a[href^="//5e1fcb75b6d662d.com/"], :root a[href^="http://googleads.g.doubleclick.net/pcs/click"], :root div[id^="ads120_600-widget"], :root a[href^="https://awejmp.com/"], :root a[href^="http://clk.directrev.com/"], :root a[href^="http://refer.webhostingbuzz.com/"], :root a[href^="http://clicks.guamwnvgashbkashawhgkhahshmashcas.pw/"], :root a[href^="http://www.downloadplayer1.com/"], :root a[href^="http://clicks.binarypromos.com/"], :root div[class^="largeRectangleAd_"], :root a[href^="https://dediseedbox.com/clients/aff.php?"], :root a[href^="http://www.wantstraffic.com/"], :root a[href^="http://databass.info/"], :root a[href^="http://www.urmediazone.com/signup"], :root a[href^="http://click.plista.com/pets"], :root a[href^="https://a.bestcontentpc.top/"], :root a[href^="http://chaturbate.com/affiliates/"], :root a[href^="http://www.firstload.com/affiliate/"], :root a[href^="http://www.friendlyadvertisements.com/"], :root a[href^="//00ae8b5a9c1d597.com/"], :root a[href^="http://cdn3.adbrau.com/"], :root a[href^="http://get.slickvpn.com/"], :root a[href^="http://amzn.to/"] > img[src^="data"], :root a[href^="http://bs.serving-sys.com/"], :root a[href^="http://cpaway.afftrack.com/"], :root a[href^="http://cdn.adsrvmedia.net/"], :root [lazy-ad="top_banner"], :root a[href^="http://360ads.go2cloud.org/"], :root a[href^="http://dftrck.com/"], :root a[href^="http://casino-x.com/?partner"], :root div[data-flt-ve="sponsored_search_ads"], :root a[href^="http://record.sportsbetaffiliates.com.au/"], :root a[href^="http://campeeks.com/"][href*="&utm_"], :root #flowplayer > div[style="position: absolute; width: 300px; height: 275px; left: 222.5px; top: 85px; z-index: 999;"], :root a[href^="http://download-performance.com/"], :root a[href^="http://www.on2url.com/app/adtrack.asp"], :root #\5f _nq__hh[style="display:block!important"], :root a[href^="http://guideways.info/"], :root a[href^="http://campaign.bharatmatrimony.com/cbstrack/"], :root a[href^="http://ads.expekt.com/affiliates/"], :root a[href^="http://callville.xyz/"], :root a[href^="http://xads.zedo.com/"], :root a[href^="http://yads.zedo.com/"], :root a[href^="https://bullads.net/get/"], :root a[href^="http://down1oads.com/"], :root a[href^="http://buysellads.com/"], :root a[href^="https://uncensored.game/"], :root td[valign="top"] > .mainmenu[style="padding:10px 0 0 0 !important;"], :root a[href^="http://feedads.g.doubleclick.net/"], :root a[href^="http://betahit.click/"], :root a[href^="http://bestorican.com/"], :root a[href^="http://bcp.crwdcntrl.net/"], :root a[href^="http://bc.vc/?r="], :root a[href^="http://www.pheedo.com/"], :root a[href^="http://banners.victor.com/processing/"], :root a[href^="http://adf.ly/?id="], :root a[href^="https://uncensored3d.com/"], :root a[href^="http://t.mdn2015x2.com/"], :root div[data-subscript="Advertising"], :root div[class$="dealnews"] > .dealnews, :root a[href^="http://click.payserve.com/"], :root a[href^="http://api.ringtonematcher.com/"], :root a[href^="http://affiliate.glbtracker.com/"], :root a[href^="https://transfer.xe.com/signup/track/redirect?"], :root a[href^="http://anonymous-net.com/"], :root a[href^="https://www.dsct1.com/"], :root a[data-oburl^="https://paid.outbrain.com/network/redir?"], :root .icons-rss-feed + .icons-rss-feed div[class$="_item"], :root a[href^="http://aflrm.com/"], :root a[href^="http://affiliates.pinnaclesports.com/processing/"], :root a[href^="http://affiliate.godaddy.com/"], :root a[href^="http://partner.sbaffiliates.com/"], :root a[href^="http://affiliate.coral.co.uk/processing/"], :root a[href^="http://aff.ironsocket.com/"], :root a[href^="http://adsrv.keycaptcha.com"], :root a[data-redirect^="https://paid.outbrain.com/network/redir?"], :root a[href^="http://play4k.co/"], :root a[href^="http://adserving.liveuniversenetwork.com/"], :root a[href^="https://zononi.com/"], :root a[href^="http://adserving.unibet.com/"], :root a[href^="http://adtransfer.net/"], :root a[href^="http://adserver.itsfogo.com/"], :root a[href^="https://secure.adnxs.com/clktrb?"], :root a[href^="http://adserver.adtechus.com/"], :root a[href^="http://adserver.adreactor.com/"], :root a[href^="http://www.yourfuckbook.com/?"], :root a[href^="//go.onclasrv.com/"], :root .GHOFUQ5BG2 > .GHOFUQ5BF2 > .GHOFUQ5BG5, :root .__ywvr .__y_item, :root #\5f _mom_ad_12, :root a[href^="http://ads.integral-marketing.com/"], :root a[href^="http://adserver.adtech.de/"], :root a[href^="http://cwcams.com/landing/click/"], :root a[href^="http://ads.betfair.com/redirect.aspx?"], :root a[href^="http://ads.affbuzzads.com/"], :root a[href^="http://tc.tradetracker.net/"], :root a[href^="http://online.ladbrokes.com/promoRedirect?"], :root a[href^="http://go.trafficshop.com/"], :root a[href^="http://ads.ad-center.com/"], :root div[id^="advt-"], :root a[href^="http://admingame.info/"], :root div[id^="q1-adset-"], :root a[href^="http://adfarm.mediaplex.com/"], :root a[href^="http://ad.doubleclick.net/"], :root a[href^="https://understandsolar.com/signup/?lead_source="][href*="&tracking_code="], :root a[href^="http://ad-emea.doubleclick.net/"], :root a[href*="/servlet/click/zone?"], :root a[href^="http://ad-apac.doubleclick.net/"], :root script[src^="http://free-shoutbox.net/app/webroot/shoutbox/sb.php?shoutbox="] + #freeshoutbox_content, :root a[href^="http://hdplugin.flashplayer-updates.com/"], :root .trc_rbox_div .syndicatedItem, :root a[href^="http://data.ad.yieldmanager.net/"], :root a[href^="http://a63t9o1azf.com/"], :root a[href^="http://srvpub.com/"], :root a[href^="http://a.adquantix.com/"], :root a[href^="http://NowDownloadAll.com"], :root #assetsListings[style="display: block;"], :root a[href^="http://9nl.es/"], :root a[href^="http://abc2.mobile-10.com/"], :root a[href^="http://adtrack123.pl/"], :root [id*="MGWrap"], :root a[href^="http://9amq5z4y1y.com/"], :root a[href^="http://4c7og3qcob.com/"], :root a[href^="//go.vedohd.org/"], :root a[href^="http://www.ducksnetwork.com/"], :root a[href^="http://3wr110.net/"], :root a[href^="http://www5.smartadserver.com/call/pubjumpi/"], :root a[href^="http://1phads.com/"], :root #MAIN.ShowTopic > .ad, :root a[href^="https://porngames.adult/?SID="], :root a[href^="http://findersocket.com/"], :root a[href^="https://m.do.co/c/"] > img, :root a[href^="http://connectlinking6.com/"], :root a[href^="https://spygasm.com/track?"], :root a[href^="http://cdn3.adexprts.com/"], :root #tads + div + .c, :root a[href^="//jsmptjmp.com/"], :root a[href^="https://ilovemyfreedoms.com/"][href*="?affiliate_id="], :root a[href^="//healthaffiliate.center/"], :root a[href^="http://games.ucoz.ru/"][target="_blank"], :root [id*="ScriptRoot"], :root a[href^="//db52cc91beabf7e8.com/"], :root a[href^="http://ads.activtrades.com/"], :root div[id^="drudge-column-ads-"], :root .plistaList > .plista_widget_underArticle_item[data-type="pet"], :root #center_col > #taw > #tvcap > .commercial-unit-desktop-top, :root a[href^="http://www.afgr2.com/"], :root #mn div[style="position:relative"] > #center_col > ._Ak, :root a[href^="https://www.oboom.com/ad/"], :root a[href^="//4f6b2af479d337cf.com/"], :root a[href^="https://www.friendlyduck.com/AF_"], :root #center_col > #resultStats + div + #res + #tads, :root a[href^="//40ceexln7929.com/"], :root div[id^="div-gpt-ad"], :root a[href^="http://fusionads.net"], :root a[href^=" http://www.sex.com/"][href*="&utm_"], :root .section-result[data-result-ad-type], :root a[href^=" http://ads.ad-center.com/"], :root div[id^="dfp-slot-"], :root .l-container > #fishtank, :root a[href^="https://fileboom.me/pr/"], :root .GPMV2XEDA2 > .GPMV2XEDP1 > .GPMV2XEDJBB, :root a[href*="onclkds."], :root #ads > .dose > .dosesingle, :root a[href*="delivery.trafficfabrik.com"], :root a[href*="=exoclick"], :root div[class^="backfill-taboola-home-slot-"], :root a[href*="=adscript"], :root #mn #center_col > div > h2.spon:first-child, :root FBS-AD, :root .ra[align="right"][width="30%"], :root a[href*="5iclx7wa4q.com"], :root a[href*=".revimedia.com/"], :root [lazy-ad="leftbottom_banner"], :root p[id^="div-gpt-ad-"], :root a[href^="http://fsoft4down.com/"], :root a[href*="ad2upapp.com/"], :root .inlineNewsletterSubscription + .inlineNewsletterSubscription div[class$="_item"], :root #taw > .med + div > #tvcap > .mnr-c:not(.qs-ic) > .commercial-unit-mobile-top, :root .plista_widget_belowArticleRelaunch_item[data-type="pet"], :root div[data-mediatype="advertising"], :root .mw > #rcnt > #center_col > #taw > #tvcap > .c, :root a[href^="https://playuhd.host/"], :root a[href^="http://mgid.com/"], :root a[href*=".adsrv.eacdn.com/"] > img, :root a[href^="http://lp.ilivid.com/"], :root a[href^="http://secure.hostgator.com/~affiliat/"], :root [onclick^="window.open('http://adultfriendfinder.com/search/"], :root a[href^="http://data.committeemenencyclopedicrepertory.info/"], :root a[href*=".allsports4you.club"], :root a[href^="http://spygasm.com/track?"], :root .ob_dual_right > .ob_ads_header ~ .odb_div, :root a[href*=".adk2x.com/"], :root a[href^="http://duckcash.eu/"], :root a[href^="http://www.mobileandinternetadvertising.com/"], :root .GB3L-QEDGY .GB3L-QEDF- > .GB3L-QEDE-, :root a[data-url^="http://paid.outbrain.com/network/redir?"] + .author, :root a[href^="http://liversely.net/"], :root .ra[width="30%"][align="right"] + table[width="70%"][cellpadding="0"], :root iframe[id^="google_ads_frame"], :root a[href^="http://www.bluehost.com/track/"] > img, :root a[data-url^="http://paid.outbrain.com/network/redir?"], :root a[href^="http://n.admagnet.net/"], :root a[href^="http://bestchickshere.com/"], :root a[href^="http://www.streamtunerhd.com/signup?"], :root #ssmiwdiv[jsdisplay], :root a[href^="//awejmp.com/"], :root a[href^="http://www.getyourguide.com/?partner_id="], :root [onclick^="window.open('https://www.brazzersnetwork.com/landing/"], :root a[href*="a2g-secure.com"], :root #resultspanel > #topads, :root a[href^="http://espn.zlbu.net/"], :root a[href^="http://k2s.cc/pr/"], :root [onclick^="window.open('window.open('//delivery.trafficfabrik.com/"], :root a[href^="http://adrunnr.com/"], :root [lazy-ad="leftthin_banner"], :root [id*="MarketGid"], :root a[href^="http://www.accuserveadsystem.com/accuserve-go.php?"], :root a[href^="http://c.ketads.com/"], :root a[href^="http://6kup12tgxx.com/"], :root a[target="_blank"][onmousedown="this.href^='http://paid.outbrain.com/network/redir?"], :root a[href^="http://hd-plugins.com/download/"], :root a[href^="//voyeurhit.com/cs/"], :root a[href^="http://www.afgr3.com/"], :root [ad-id^="googlead"], :root a[href^="https://topoffers.com/"][href*="/?pid="], :root a[href^="http://vinfdv6b4j.com/"], :root a[href^="http://bonusfapturbo.nmvsite.com/"], :root a[href^="//porngames.adult/?SID="], :root DFP-AD, :root a[href^="//www.mgid.com/"], :root #center_col > div[style="font-size:14px;margin-right:0;min-height:5px"] > div[style="font-size:14px;margin:0 4px;padding:1px 5px;background:#fff8e7"], :root a[href^="http://track.affiliatenetwork.co.za/"], :root a[data-redirect^="http://paid.outbrain.com/network/redir?"], :root .jobs-information-call-to-action + .jobs-information-call-to-action div[class$="_item"], :root a[href^="http://servicegetbook.net/"], :root #rhs_block > #mbEnd, :root a[href^="http://cinema.friendscout24.de?"], :root [lazy-ad="lefttop_banner"], :root .__y_inner > .__y_item, :root a[href^="https://secure.cbdpure.com/aff/"], :root AMP-AD, :root a[href^="http://adclick.g.doubleclick.net/"], :root #main-content > [style="padding:10px 0 0 0 !important;"], :root #center_col > #resultStats + div[style="border:1px solid #dedede;margin-bottom:11px;padding:5px 7px 5px 6px"], :root div[class^="lifeOnwerAd"], :root a[data-oburl^="http://paid.outbrain.com/network/redir?"], :root iframe[src^="http://cdn1.adexprt.com/"], :root a[href^="http://dwn.pushtraffic.net/"], :root a[href$="/vghd.shtml"], :root a[href^="https://redirect.ero-advertising.com/"], :root a[href^="http://easydownload4you.com/"], :root a[href^="http://ffxitrack.com/"], :root #center_col > #main > .dfrd > .mnr-c > .c._oc._zs, :root a[href^="http://b.bestcompleteusa.info/"], :root .trc_rbox_div .syndicatedItemUB, :root #mn div[style="position:relative"] > #center_col > div > ._dPg, :root a[href^="http://www.myvpn.pro/"], :root a[href^="//www.pd-news.com/"], :root a[href^="http://www.pinkvisualpad.com/?revid="], :root a[href*=".clksite.com/"], :root a[href^="http://www.webtrackerplus.com/"], :root .GJJKPX2N1 > .GJJKPX2M1 > .GJJKPX2P4, :root #center_col > #taw > #tvcap > .cu-container > .commercial-unit-desktop-top, :root a[href^="http://centertrust.xyz/"], :root a[href^="https://intrev.co/"], :root div[id^="google_ads_iframe_"], :root .vi-lb-placeholder[title="ADVERTISEMENT"], :root a[href^="http://goldmoney.com/?gmrefcode="], :root a[href^="http://papi.mynativeplatform.com:80/pub2/"], :root LEADERBOARD-AD, :root #mn #center_col > div > h2.spon:first-child + ol:last-child, :root a[href^="https://bongacams2.com/track?"], :root a[href^="//zenhppyad.com/"], :root .gbfwa > div[class$="_item"], :root a[href^="http://www.menaon.com/installs/"], :root a[href^="http://taboola-"][href*="/redirect.php?app.type="], :root .mw > #rcnt > #center_col > #taw > .c, :root a[href^="http://api.content.ad/"], :root a[href*=".clkcln.com/"], :root .commercial-unit-desktop-rhs > .iKidV > .Ee92ae + .P2mpm + .hp3sk, :root a[href^="http://prochina.space/"], :root a[href^="http://www.uniblue.com/cm/"], :root a[href^="http://landingpagegenius.com/"], :root a[data-redirect^="http://click.plista.com/pets"], :root #rhs_block > script + .c._oc._Ve.rhsvw, :root .__zinit .__y_item, :root .ch[onclick="ga(this,event)"], :root a[href^="http://track.incognitovpn.com/"], :root .__ywl .__y_item, :root a[href^="http://track.trkvluum.com/"], :root a[href*="/adrotate-out.php?"], :root a[href^="http://linksnappy.com/?ref="], :root [src^="/Redirect.a2b?"], :root a[href^="http://www.torntvdl.com/"], :root #center_col > #resultStats + #tads, :root .__yinit .__y_item, :root .ra[align="left"][width="30%"], :root a[href^="https://trackjs.com/?utm_source"], :root AFS-AD, :root #cnt #center_col > #res > #topstuff > .ts, :root a[href^="https://landing.brazzersnetwork.com/"], :root a[href^="http://www.firstclass-download.com/"], :root a[href*=".trust.zone"], :root a[href*="googleme.eu"], :root .mod > ._jH + .rscontainer, :root .GFYY1SVD2 > .GFYY1SVC2 > .GFYY1SVF5, :root a[href^="https://dcs.adgear.com/clicks/"], :root a[href^="http://affiliates.score-affiliates.com/"], :root #rhswrapper > #rhssection[border="0"][bgcolor="#ffffff"], :root .Mpopup + #Mad > #MadZone, :root a[href^="https://www.adxtro.com/"], :root #center_col > #\5f Emc, :root div[id^="dfp-ad-"], :root a[href^="http://ads2.williamhill.com/redirect.aspx?"], :root a[href^="https://www.spyoff.com/"], :root AD-TRIPLE-BOX, :root a[href^="//z6naousb.com/"], :root .rc-cta[data-target], :root #rhs_block > .ts[cellspacing="0"][cellpadding="0"][style="padding:0"], :root #header + #content > #left > #rlblock_left, :root a[href^="http://www.seekbang.com/cs/"], :root a[href^="http://syndication.exoclick.com/"], :root a[href^="http://bluehost.com/track/"], :root a[href^="https://squren.com/rotator/?atomid="], :root .nrelate .nr_partner, :root #center_col > #resultStats + #tads + #res + #tads, :root a[href^="//medleyads.com/spot/"], :root a[href*="mfroute.com/"], :root #rhs_block > ol > .rhsvw > .kp-blk > .xpdopen > ._OKe > ol > ._DJe > .luhb-div, :root a[href^="http://tezfiles.com/pr/"], :root a[href^="http://t.wowtrk.com/"], :root #center_col > #taw > #tvcap > .rscontainer, :root #main_col > #center_col div[style="font-size:14px;margin:0 4px;padding:1px 5px;background:#fff7ed"], :root a[href^="http://webtrackerplus.com/"], :root a[href^="http://clickandjoinyourgirl.com/"], :root div[itemtype="http://schema.org/WPAdBlock"], :root a[href^="https://www.nudeidols.com/cams/"], :root #center_col > #res > #topstuff + #search > div > #ires > #rso > #flun, :root a[href^="http://www.sex.com/pics/?utm_"], :root a[href^="http://vo2.qrlsx.com/"], :root a[href^="http://engine.newsmaxfeednetwork.com/"], :root a[href^="http://ad.yieldmanager.com/"], :root a[href^="http://www.plus500.com/?id="], :root #flowplayer > div[style="z-index: 208; position: absolute; width: 300px; height: 275px; left: 222.5px; top: 85px;"], :root a[href^="http://ddownload39.club/"], :root a[href^="http://n217adserv.com/"], :root a[href^="//4c7og3qcob.com/"] { display: none !important; }</style></head>
<body class="language-php">

    <div class="sidebar_layout" id="docsScreen">

        <div class="page_contain">
            <div class="contain">
                <aside class="sidebar">
                    <a href="../02-Getting%20Started/01-Installation.html" class="logo">
                        <img class="mark" src="../index_files/logomark.min.svg" alt="Laravel">
                        <img class="type" src="../index_files/logotype.min.svg" alt="Laravel">
                    </a>
                    <nav>
                        <div class="navigation_contain" style="display: block;">
                            <div class="docs_sidebar">
                                <ul>
                                    <li class="">
                                        <h2>Prologue</h2>
                                        <ul>
                                            <li><a href="../01-Prologue/01-Release%20Notes.html">Release Notes</a></li>
                                            <li><a href="../01-Prologue/02-Upgrade%20Guide.html">Upgrade Guide</a></li>
                                            <li><a href="../01-Prologue/03-Contribution%20Guide.html">Contribution Guide</a></li>
                                            <li><a href="https://laravel.com/api/6.0">API Documentation</a></li>
                                        </ul>
                                    </li>
                                    <li class="">
                                        <h2>Getting Started</h2>
                                        <ul>
                                            <li><a href="../02-Getting%20Started/01-Installation.html">Installation</a></li>
                                            <li><a href="../02-Getting%20Started/02-Configuration.html">Configuration</a></li>
                                            <li><a href="../02-Getting%20Started/03-Directory%20Structure.html">Directory Structure</a></li>
                                            <li><a href="../02-Getting%20Started/04-Homestead.html">Homestead</a></li>
                                            <li><a href="../02-Getting%20Started/05-Valet.html">Valet</a></li>
                                            <li><a href="../02-Getting%20Started/06-Deployment.html">Deployment</a></li>
                                        </ul>
                                    </li>
                                    <li class="">
                                        <h2>Architecture Concepts</h2>
                                        <ul>
                                            <li><a href="../03-Architecture%20Concepts/01-Request%20Lifecycle.html">Request Lifecycle</a></li>
                                            <li><a href="../03-Architecture%20Concepts/02-Service%20Container.html">Service Container</a></li>
                                            <li><a href="../03-Architecture%20Concepts/03-Service%20Providers.html">Service Providers</a></li>
                                            <li><a href="../03-Architecture%20Concepts/04-Facades.html">Facades</a></li>
                                            <li><a href="../03-Architecture%20Concepts/05-Contracts.html">Contracts</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>The Basics</h2>
                                        <ul>
                                            <li><a href="../04-The%20Basics/01-Routing.html">Routing</a></li>
                                            <li><a href="../04-The%20Basics/02-Middleware.html">Middleware</a></li>
                                            <li><a href="../04-The%20Basics/03-CSRF%20Protection.html">CSRF Protection</a></li>
                                            <li><a href="../04-The%20Basics/04-Controllers.html">Controllers</a></li>
                                            <li><a href="../04-The%20Basics/05-Requests.html">Requests</a></li>
                                            <li><a href="../04-The%20Basics/06-Responses.html">Responses</a></li>
                                            <li><a href="../04-The%20Basics/07-Views.html">Views</a></li>
                                            <li><a href="../04-The%20Basics/08-URL%20Generation.html">URL Generation</a></li>
                                            <li><a href="../04-The%20Basics/09-Session.html">Session</a></li>
                                            <li><a href="../04-The%20Basics/10-Validation.html">Validation</a></li>
                                            <li><a href="../04-The%20Basics/11-Error%20Handling.html">Error Handling</a></li>
                                            <li><a href="../04-The%20Basics/12-Logging.html">Logging</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Frontend</h2>
                                        <ul>
                                            <li><a href="../05-Frontend/01-Blade%20Templates.html">Blade Templates</a></li>
                                            <li><a href="../05-Frontend/02-Localization.html">Localization</a></li>
                                            <li><a href="../05-Frontend/03-Frontend%20Scaffolding.html">Frontend Scaffolding</a></li>
                                            <li><a href="../05-Frontend/04-Compiling%20Assets.html">Compiling Assets</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Security</h2>
                                        <ul>
                                            <li><a href="../06-Security/01-Authentication.html">Authentication</a></li>
                                            <li><a href="../06-Security/02-API%20Authentication.html">API Authentication</a></li>
                                            <li><a href="../06-Security/03-Authorization.html">Authorization</a></li>
                                            <li><a href="../06-Security/04-Email%20Verification.html">Email Verification</a></li>
                                            <li><a href="../06-Security/05-Encryption.html">Encryption</a></li>
                                            <li><a href="../06-Security/06-Hashing.html">Hashing</a></li>
                                            <li><a href="../06-Security/07-Password%20Reset.html">Password Reset</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Digging Deeper</h2>
                                        <ul>
                                            <li><a href="../07-Digging%20Deeper/01-Artisan%20Console.html">Artisan Console</a></li>
                                            <li><a href="../07-Digging%20Deeper/02-Broadcasting.html">Broadcasting</a></li>
                                            <li><a href="../07-Digging%20Deeper/03-Cache.html">Cache</a></li>
                                            <li><a href="../07-Digging%20Deeper/04-Collections.html">Collections</a></li>
                                            <li><a href="../07-Digging%20Deeper/05-Events.html">Events</a></li>
                                            <li><a href="../07-Digging%20Deeper/06-File%20Storage.html">File Storage</a></li>
                                            <li><a href="../07-Digging%20Deeper/07-Helpers.html">Helpers</a></li>
                                            <li><a href="../07-Digging%20Deeper/08-Mail.html">Mail</a></li>
                                            <li><a href="../07-Digging%20Deeper/09-Notifications.html">Notifications</a></li>
                                            <li><a href="../07-Digging%20Deeper/10-Package%20Development.html">Package Development</a></li>
                                            <li><a href="../07-Digging%20Deeper/11-Queues.html">Queues</a></li>
                                            <li><a href="../07-Digging%20Deeper/12-Task%20Scheduling.html">Task Scheduling</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Database</h2>
                                        <ul>
                                            <li><a href="../08-Database/01-Getting%20Started.html">Getting Started</a></li>
                                            <li><a href="../08-Database/02-Query%20Builder.html">Query Builder</a></li>
                                            <li><a href="../08-Database/03-Pagination.html">Pagination</a></li>
                                            <li><a href="../08-Database/04-Migrations.html">Migrations</a></li>
                                            <li><a href="../08-Database/05-Seeding.html">Seeding</a></li>
                                            <li><a href="../08-Database/06-Redis.html">Redis</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Eloquent ORM</h2>
                                        <ul>
                                            <li><a href="../09-Eloquent%20ORM/01-Getting%20Started.html">Getting Started</a></li>
                                            <li><a href="../09-Eloquent%20ORM/02-Relationships.html">Relationships</a></li>
                                            <li><a href="../09-Eloquent%20ORM/03-Collections.html">Collections</a></li>
                                            <li><a href="../09-Eloquent%20ORM/04-Mutators.html">Mutators</a></li>
                                            <li><a href="../09-Eloquent%20ORM/05-API%20Resources.html">API Resources</a></li>
                                            <li><a href="../09-Eloquent%20ORM/06-Serialization.html">Serialization</a></li>
                                        </ul>
                                    </li>
                                    <li class="sub--on">
                                        <h2>Testing</h2>
                                        <ul>
                                            <li><a href="../10-Testing/01-Getting%20Started.html">Getting Started</a></li>
                                            <li><a href="../10-Testing/02-HTTP%20Tests.html">HTTP Tests</a></li>
                                            <li><a href="../10-Testing/03-Console%20Tests.html">Console Tests</a></li>
                                            <li><a href="../10-Testing/04-Browser%20Tests.html">Browser Tests</a></li>
                                            <li><a href="../10-Testing/05-Database.html">Database</a></li>
                                            <li><a href="../10-Testing/06-Mocking.html">Mocking</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Official Packages</h2>
                                        <ul>
                                            <li><a href="../11-Official%20Packages/01-Cashier.html">Cashier</a></li>
                                            <li><a href="../10-Testing/04-Browser%20Tests.html">Dusk</a></li>
                                            <li><a href="../11-Official%20Packages/03-Envoy.html">Envoy</a></li>
                                            <li><a href="../11-Official%20Packages/04-Horizon.html">Horizon</a></li>
                                            <li><a href="../11-Official%20Packages/05-Passport.html">Passport</a></li>
                                            <li><a href="../11-Official%20Packages/06-Scout.html">Scout</a></li>
                                            <li><a href="../11-Official%20Packages/07-Socialite.html">Socialite</a></li>
                                            <li><a href="../11-Official%20Packages/08-Telescope.html">Telescope</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>

                            <script async="" type="text/javascript" src="../index_files/carbon.js.download" id="_carbonads_js" style="display: none !important;"></script>


                        </div>
                    </nav>
                    <div class="trigger_contain">
                        <a href="https://laravel.com/docs/6.0#" class="nav_trigger"><div class="bar"></div></a>
                    </div>
                </aside>

                <section class="body_content">

                    <section class="docs_body">
                        <section class="docs_main">
                            <h1>Laravel Cashier</h1>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#upgrading-cashier">Upgrading Cashier</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration">Configuration</a>
<ul>
<li><a href="#billable-model">Billable Model</a></li>
<li><a href="#api-keys">API Keys</a></li>
<li><a href="#currency-configuration">Currency Configuration</a></li>
</ul></li>
<li><a href="#customers">Customers</a>
<ul>
<li><a href="#creating-customers">Creating Customers</a></li>
</ul></li>
<li><a href="#payment-methods">Payment Methods</a>
<ul>
<li><a href="#storing-payment-methods">Storing Payment Methods</a></li>
<li><a href="#retrieving-payment-methods">Retrieving Payment Methods</a></li>
<li><a href="#check-for-a-payment-method">Determining If A User Has A Payment Method</a></li>
<li><a href="#updating-the-default-payment-method">Updating The Default Payment Method</a></li>
<li><a href="#adding-payment-methods">Adding Payment Methods</a></li>
<li><a href="#deleting-payment-methods">Deleting Payment Methods</a></li>
</ul></li>
<li><a href="#subscriptions">Subscriptions</a>
<ul>
<li><a href="#creating-subscriptions">Creating Subscriptions</a></li>
<li><a href="#checking-subscription-status">Checking Subscription Status</a></li>
<li><a href="#changing-plans">Changing Plans</a></li>
<li><a href="#subscription-quantity">Subscription Quantity</a></li>
<li><a href="#subscription-taxes">Subscription Taxes</a></li>
<li><a href="#subscription-anchor-date">Subscription Anchor Date</a></li>
<li><a href="#cancelling-subscriptions">Cancelling Subscriptions</a></li>
<li><a href="#resuming-subscriptions">Resuming Subscriptions</a></li>
</ul></li>
<li><a href="#subscription-trials">Subscription Trials</a>
<ul>
<li><a href="#with-payment-method-up-front">With Payment Method Up Front</a></li>
<li><a href="#without-payment-method-up-front">Without Payment Method Up Front</a></li>
</ul></li>
<li><a href="#handling-stripe-webhooks">Handling Stripe Webhooks</a>
<ul>
<li><a href="#defining-webhook-event-handlers">Defining Webhook Event Handlers</a></li>
<li><a href="#handling-failed-subscriptions">Failed Subscriptions</a></li>
<li><a href="#verifying-webhook-signatures">Verifying Webhook Signatures</a></li>
</ul></li>
<li><a href="#single-charges">Single Charges</a>
<ul>
<li><a href="#simple-charge">Simple Charge</a></li>
<li><a href="#charge-with-invoice">Charge With Invoice</a></li>
<li><a href="#refunding-charges">Refunding Charges</a></li>
</ul></li>
<li><a href="#invoices">Invoices</a>
<ul>
<li><a href="#generating-invoice-pdfs">Generating Invoice PDFs</a></li>
</ul></li>
<li><a href="#strong-customer-authentication">Strong Customer Authentication (SCA)</a>
<ul>
<li><a href="#payments-requiring-additional-confirmation">Payments Requiring Additional Confirmation</a></li>
<li><a href="#off-session-payment-notifications">Off-session Payment Notifications</a></li>
</ul></li>
</ul>
<p><a name="introduction"></a></p>
<h2><a href="#introduction">Introduction</a></h2>
<p>Laravel Cashier provides an expressive, fluent interface to <a href="https://stripe.com/">Stripe's</a> subscription billing services. It handles almost all of the boilerplate subscription billing code you are dreading writing. In addition to basic subscription management, Cashier can handle coupons, swapping subscription, subscription "quantities", cancellation grace periods, and even generate invoice PDFs.</p>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> To prevent breaking changes, Cashier uses a fixed Stripe API version. Cashier 10.1 utilizes Stripe API version <code class=" language-php"><span class="token number">2019</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">14</span></code>. The Stripe API version will be updated on minor releases in order to make use of new Stripe features and improvements.</p></div>
</blockquote>
<p><a name="upgrading-cashier"></a></p>
<h2><a href="#upgrading-cashier">Upgrading Cashier</a></h2>
<p>When upgrading to a new version of Cashier, it's important that you carefully review <a href="https://github.com/laravel/cashier/blob/master/UPGRADE.md">the upgrade guide</a>.</p>
<p><a name="installation"></a></p>
<h2><a href="#installation">Installation</a></h2>
<p>First, require the Cashier package for Stripe with Composer:</p>
<pre class=" language-php"><code class=" language-php">composer <span class="token keyword">require</span> laravel<span class="token operator">/</span>cashier</code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> To ensure Cashier properly handles all Stripe events, remember to <a href="#handling-stripe-webhooks">set up Cashier's webhook handling</a>.</p></div>
</blockquote>
<h4>Database Migrations</h4>
<p>The Cashier service provider registers its own database migration directory, so remember to migrate your database after installing the package. The Cashier migrations will add several columns to your <code class=" language-php">users</code> table as well as create a new <code class=" language-php">subscriptions</code> table to hold all of your customer's subscriptions:</p>
<pre class=" language-php"><code class=" language-php">php artisan migrate</code></pre>
<p>If you need to overwrite the migrations that ship with the Cashier package, you can publish them using the <code class=" language-php">vendor<span class="token punctuation">:</span>publish</code> Artisan command:</p>
<pre class=" language-php"><code class=" language-php">php artisan vendor<span class="token punctuation">:</span>publish <span class="token operator">--</span>tag<span class="token operator">=</span><span class="token double-quoted-string string">"cashier-migrations"</span></code></pre>
<p>If you would like to prevent Cashier's migrations from running entirely, you may use the <code class=" language-php">ignoreMigrations</code> provided by Cashier. Typically, this method should be called in the <code class=" language-php">register</code> method of your <code class=" language-php">AppServiceProvider</code>:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Cashier<span class="token punctuation">\</span>Cashier</span><span class="token punctuation">;</span>

Cashier<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ignoreMigrations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> Stripe recommends that any column used for storing Stripe identifiers should be case-sensitive. Therefore, you should ensure the column collation for the <code class=" language-php">stripe_id</code> column is set to, for example, <code class=" language-php">utf8_bin</code> in MySQL. More info can be found <a href="https://stripe.com/docs/upgrades#what-changes-does-stripe-consider-to-be-backwards-compatible">in the Stripe documentation</a>.</p></div>
</blockquote>
<p><a name="configuration"></a></p>
<h2><a href="#configuration">Configuration</a></h2>
<p><a name="billable-model"></a></p>
<h3><a href="#billable-model">Billable Model</a></h3>
<p>Before using Cashier, add the <code class=" language-php">Billable</code> trait to your model definition. This trait provides various methods to allow you to perform common billing tasks, such as creating subscriptions, applying coupons, and updating payment method information:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Cashier<span class="token punctuation">\</span>Billable</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Billable</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Cashier assumes your Billable model will be the <code class=" language-php">App\<span class="token package">User</span></code> class that ships with Laravel. If you wish to change this you can specify a different model in your <code class=" language-php"><span class="token punctuation">.</span>env</code> file:</p>
<pre class=" language-php"><code class=" language-php"><span class="token constant">CASHIER_MODEL</span><span class="token operator">=</span>App\<span class="token package">User</span></code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> If you're using a model other than Laravel's supplied <code class=" language-php">App\<span class="token package">User</span></code> model, you'll need to publish and alter the <a href="#installation">migrations</a> provided to match your alternative model's table name.</p></div>
</blockquote>
<p><a name="api-keys"></a></p>
<h3><a href="#api-keys">API Keys</a></h3>
<p>Next, you should configure your Stripe key in your <code class=" language-php"><span class="token punctuation">.</span>env</code> file. You can retrieve your Stripe API keys from the Stripe control panel.</p>
<pre class=" language-php"><code class=" language-php"><span class="token constant">STRIPE_KEY</span><span class="token operator">=</span>your<span class="token operator">-</span>stripe<span class="token operator">-</span>key
<span class="token constant">STRIPE_SECRET</span><span class="token operator">=</span>your<span class="token operator">-</span>stripe<span class="token operator">-</span>secret</code></pre>
<p><a name="currency-configuration"></a></p>
<h3><a href="#currency-configuration">Currency Configuration</a></h3>
<p>The default Cashier currency is United States Dollars (USD). You can change the default currency by setting the <code class=" language-php"><span class="token constant">CASHIER_CURRENCY</span></code> environment variable:</p>
<pre class=" language-php"><code class=" language-php"><span class="token constant">CASHIER_CURRENCY</span><span class="token operator">=</span>eur</code></pre>
<p>In addition to configuring Cashier's currency, you may also specify a locale to be used when formatting money values for display on invoices. Internally, Cashier utilizes <a href="https://www.php.net/manual/en/class.numberformatter.php">PHP's <code class=" language-php">NumberFormatter</code> class</a> to set the currency locale:</p>
<pre class=" language-php"><code class=" language-php"><span class="token constant">CASHIER_CURRENCY_LOCALE</span><span class="token operator">=</span>nl_BE</code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> In order to use locales other than <code class=" language-php">en</code>, ensure the <code class=" language-php">ext<span class="token operator">-</span>intl</code> PHP extension is installed and configured on your server.</p></div>
</blockquote>
<p><a name="customers"></a></p>
<h2><a href="#customers">Customers</a></h2>
<p><a name="creating-customers"></a></p>
<h3><a href="#creating-customers">Creating Customers</a></h3>
<p>Occasionally, you may wish to create a Stripe customer without beginning a subscription. You may accomplish this using the <code class=" language-php">createAsStripeCustomer</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">createAsStripeCustomer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Once the customer has been created in Stripe, you may begin a subscription at a later date.</p>
<p><a name="payment-methods"></a></p>
<h2><a href="#payment-methods">Payment Methods</a></h2>
<p><a name="storing-payment-methods"></a></p>
<h3><a href="#storing-payment-methods">Storing Payment Methods</a></h3>
<p>In order to create subscriptions or perform "one off" charges with Stripe, you will need to store a payment method and retrieve its identifier from Stripe. The approach used to accomplish differs based on whether you plan to use the payment method for subscriptions or single charges, so we will examine both below.</p>
<h4>Payment Methods For Subscriptions</h4>
<p>When storing credit cards to a customer for future use, the Stripe Setup Intents API must be used to securely gather the customer's payment method details. A "Setup Intent" indicates to Stripe the intention to charge a customer's payment method. Cashier's <code class=" language-php">Billable</code> trait includes the <code class=" language-php">createSetupIntent</code> to easily create a new Setup Intent. You should call this method from the route or controller that will render the form which gathers your customer's payment method details:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'update-payment-method'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'intent'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">createSetupIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>After you have created the Setup Intent and passed it to the view, you should attach its secret to the element that will gather the payment method. For example, consider this "update payment method" form:</p>
<pre class=" language-php"><code class=" language-php"><span class="token operator">&lt;</span>input id<span class="token operator">=</span><span class="token double-quoted-string string">"card-holder-name"</span> type<span class="token operator">=</span><span class="token double-quoted-string string">"text"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Stripe Elements Placeholder <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token double-quoted-string string">"card-element"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token double-quoted-string string">"card-button"</span> data<span class="token operator">-</span>secret<span class="token operator">=</span><span class="token double-quoted-string string">"{{ <span class="token interpolation"><span class="token variable">$intent</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">client_secret</span></span> }}"</span><span class="token operator">&gt;</span>
    Update Payment Method
<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></code></pre>
<p>Next, the Stripe.js library may be used to attach a Stripe Element to the form and securely gather the customer's payment details:</p>
<pre class=" language-php"><code class=" language-php"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token double-quoted-string string">"https://js.stripe.com/v3/"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">const</span> stripe <span class="token operator">=</span> <span class="token function">Stripe</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'stripe-public-key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> elements <span class="token operator">=</span> stripe<span class="token punctuation">.</span><span class="token function">elements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> cardElement <span class="token operator">=</span> elements<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'card'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    cardElement<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'#card-element'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></code></pre>
<p>Next, the card can be verified and a secure "payment method identifier" can be retrieved from Stripe using <a href="https://stripe.com/docs/stripe-js/reference#stripe-handle-card-setup">Stripe's <code class=" language-php">handleCardSetup</code> method</a>:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">const</span> cardHolderName <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'card-holder-name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cardButton <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'card-button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> clientSecret <span class="token operator">=</span> cardButton<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>secret<span class="token punctuation">;</span>

cardButton<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'click'</span><span class="token punctuation">,</span> async <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> setupIntent<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> await stripe<span class="token punctuation">.</span><span class="token function">handleCardSetup</span><span class="token punctuation">(</span>
        clientSecret<span class="token punctuation">,</span> cardElement<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            payment_method_data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                billing_details<span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> cardHolderName<span class="token punctuation">.</span>value <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Display "error.message" to the user...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// The card has been verified successfully...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>After the card has been verified by Stripe, you may pass the resulting <code class=" language-php">setupIntent<span class="token punctuation">.</span>payment_method</code> identifier to your Laravel application, where it can be attached to the customer. The payment method can either be <a href="#adding-payment-methods">added as a new payment method</a> or <a href="#updating-the-default-payment-method">used to update the default payment method</a>. You can also immediately use the payment method identifier to <a href="#creating-subscriptions">create a new subscription</a>.</p>
<blockquote>
<div class="callout"><div class="icon purple"><img src="./01-Cashier_files/lightbulb.min.svg"></div><p class="content"> If you would like more information about Setup Intents and gathering customer payment details please <a href="https://stripe.com/docs/payments/cards/saving-cards#saving-card-without-payment">review this overview provided by Stripe</a>.</p></div>
</blockquote>
<h4>Payment Methods For Single Charges</h4>
<p>Of course, when making a single charge against a customer's payment method we'll only need to use a payment method identifier a single time. Due to Stripe limitations, you may not use the stored default payment method of a customer for single charges. You must allow the customer to enter their payment method details using the Stripe.js library. For example, consider the following form:</p>
<pre class=" language-php"><code class=" language-php"><span class="token operator">&lt;</span>input id<span class="token operator">=</span><span class="token double-quoted-string string">"card-holder-name"</span> type<span class="token operator">=</span><span class="token double-quoted-string string">"text"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Stripe Elements Placeholder <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token double-quoted-string string">"card-element"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token double-quoted-string string">"card-button"</span><span class="token operator">&gt;</span>
    Process Payment
<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></code></pre>
<p>Next, the Stripe.js library may be used to attach a Stripe Element to the form and securely gather the customer's payment details:</p>
<pre class=" language-php"><code class=" language-php"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token double-quoted-string string">"https://js.stripe.com/v3/"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">const</span> stripe <span class="token operator">=</span> <span class="token function">Stripe</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'stripe-public-key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> elements <span class="token operator">=</span> stripe<span class="token punctuation">.</span><span class="token function">elements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> cardElement <span class="token operator">=</span> elements<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'card'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    cardElement<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'#card-element'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></code></pre>
<p>Next, the card can be verified and a secure "payment method identifier" can be retrieved from Stripe using <a href="https://stripe.com/docs/stripe-js/reference#stripe-create-payment-method">Stripe's <code class=" language-php">createPaymentMethod</code> method</a>:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">const</span> cardHolderName <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'card-holder-name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cardButton <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'card-button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cardButton<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'click'</span><span class="token punctuation">,</span> async <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> paymentMethod<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> await stripe<span class="token punctuation">.</span><span class="token function">createPaymentMethod</span><span class="token punctuation">(</span>
        <span class="token single-quoted-string string">'card'</span><span class="token punctuation">,</span> cardElement<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            billing_details<span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> cardHolderName<span class="token punctuation">.</span>value <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Display "error.message" to the user...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// The card has been verified successfully...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>If the card is verified successfully, you may pass the <code class=" language-php">paymentMethod<span class="token punctuation">.</span>id</code> to your Laravel application and process a <a href="#simple-charge">single charge</a>.</p>
<p><a name="retrieving-payment-methods"></a></p>
<h3><a href="#retrieving-payment-methods">Retrieving Payment Methods</a></h3>
<p>The <code class=" language-php">paymentMethods</code> method on the Billable model instance returns a collection of <code class=" language-php">Laravel\<span class="token package">Cashier<span class="token punctuation">\</span>PaymentMethod</span></code> instances:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$paymentMethods</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">paymentMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>To retrieve the default payment method, the <code class=" language-php">defaultPaymentMethod</code> method may be used;</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$paymentMethod</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">defaultPaymentMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="check-for-a-payment-method"></a></p>
<h3><a href="#check-for-a-payment-method">Determining If A User Has A Payment Method</a></h3>
<p>To determine if a Billable model has a payment method attached to their account, use the <code class=" language-php">hasPaymentMethod</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hasPaymentMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p><a name="updating-the-default-payment-method"></a></p>
<h3><a href="#updating-the-default-payment-method">Updating The Default Payment Method</a></h3>
<p>The <code class=" language-php">updateDefaultPaymentMethod</code> method may be used to update a customer's default payment method information. This method accepts a Stripe payment method identifier and will assign the new payment method as the default billing payment method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">updateDefaultPaymentMethod</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>To sync your default payment method information with the customer's default payment method information in Stripe, you may use the <code class=" language-php">updateDefaultPaymentMethodFromStripe</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">updateDefaultPaymentMethodFromStripe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> The default payment method on a customer can only be used for invoicing and creating new subscriptions. Due to limitations from Stripe, it may not be used for single charges.</p></div>
</blockquote>
<p><a name="adding-payment-methods"></a></p>
<h3><a href="#adding-payment-methods">Adding Payment Methods</a></h3>
<p>To add a new payment method, you may call the <code class=" language-php">addPaymentMethod</code> method on the billable user, passing the payment method identifier:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">addPaymentMethod</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<div class="callout"><div class="icon purple"><img src="./01-Cashier_files/lightbulb.min.svg"></div><p class="content"> To learn how to retrieve payment method identifiers please review the <a href="#storing-payment-methods">payment method storage documentation</a>.</p></div>
</blockquote>
<p><a name="deleting-payment-methods"></a></p>
<h3><a href="#deleting-payment-methods">Deleting Payment Methods</a></h3>
<p>To delete a payment method, you may call the <code class=" language-php">delete</code> method on the <code class=" language-php">Laravel\<span class="token package">Cashier<span class="token punctuation">\</span>PaymentMethod</span></code> instance you wish to delete:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$paymentMethod</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The <code class=" language-php">deletePaymentMethods</code> method will delete all of the payment method information for the Billable model:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">deletePaymentMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> If a user has an active subscription, you should prevent them from deleting their default payment method.</p></div>
</blockquote>
<p><a name="subscriptions"></a></p>
<h2><a href="#subscriptions">Subscriptions</a></h2>
<p><a name="creating-subscriptions"></a></p>
<h3><a href="#creating-subscriptions">Creating Subscriptions</a></h3>
<p>To create a subscription, first retrieve an instance of your billable model, which typically will be an instance of <code class=" language-php">App\<span class="token package">User</span></code>. Once you have retrieved the model instance, you may use the <code class=" language-php">newSubscription</code> method to create the model's subscription:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">newSubscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'premium'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The first argument passed to the <code class=" language-php">newSubscription</code> method should be the name of the subscription. If your application only offers a single subscription, you might call this <code class=" language-php">main</code> or <code class=" language-php">primary</code>. The second argument is the specific plan the user is subscribing to. This value should correspond to the plan's identifier in Stripe.</p>
<p>The <code class=" language-php">create</code> method, which accepts <a href="#storing-payment-methods">a Stripe payment method identifier</a> or Stripe <code class=" language-php">PaymentMethod</code> object, will begin the subscription as well as update your database with the customer ID and other relevant billing information.</p>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> Passing a payment method identifier directly to the <code class=" language-php"><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code> subscription method will also automatically add it to the user's stored payment methods.</p></div>
</blockquote>
<h4>Additional User Details</h4>
<p>If you would like to specify additional customer details, you may do so by passing them as the second argument to the <code class=" language-php">create</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">newSubscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'monthly'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'email'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$email</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>To learn more about the additional fields supported by Stripe, check out Stripe's <a href="https://stripe.com/docs/api#create_customer">documentation on customer creation</a>.</p>
<h4>Coupons</h4>
<p>If you would like to apply a coupon when creating the subscription, you may use the <code class=" language-php">withCoupon</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">newSubscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'monthly'</span><span class="token punctuation">)</span>
     <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">withCoupon</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'code'</span><span class="token punctuation">)</span>
     <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="checking-subscription-status"></a></p>
<h3><a href="#checking-subscription-status">Checking Subscription Status</a></h3>
<p>Once a user is subscribed to your application, you may easily check their subscription status using a variety of convenient methods. First, the <code class=" language-php">subscribed</code> method returns <code class=" language-php"><span class="token boolean constant">true</span></code> if the user has an active subscription, even if the subscription is currently within its trial period:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscribed</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p>The <code class=" language-php">subscribed</code> method also makes a great candidate for a <a href="https://laravel.com/docs/6.0/middleware">route middleware</a>, allowing you to filter access to routes and controllers based on the user's subscription status:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> Closure <span class="token variable">$next</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscribed</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// This user is not a paying customer...</span>
        <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'billing'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token variable">$next</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>If you would like to determine if a user is still within their trial period, you may use the <code class=" language-php">onTrial</code> method. This method can be useful for displaying a warning to the user that they are still on their trial period:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p>The <code class=" language-php">subscribedToPlan</code> method may be used to determine if the user is subscribed to a given plan based on a given Stripe plan ID. In this example, we will determine if the user's <code class=" language-php">main</code> subscription is actively subscribed to the <code class=" language-php">monthly</code> plan:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscribedToPlan</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'monthly'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p>The <code class=" language-php">recurring</code> method may be used to determine if the user is currently subscribed and is no longer within their trial period:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">recurring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<h4>Cancelled Subscription Status</h4>
<p>To determine if the user was once an active subscriber, but has cancelled their subscription, you may use the <code class=" language-php">cancelled</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">cancelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p>You may also determine if a user has cancelled their subscription, but are still on their "grace period" until the subscription fully expires. For example, if a user cancels a subscription on March 5th that was originally scheduled to expire on March 10th, the user is on their "grace period" until March 10th. Note that the <code class=" language-php">subscribed</code> method still returns <code class=" language-php"><span class="token boolean constant">true</span></code> during this time:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onGracePeriod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p>To determine if the user has cancelled their subscription and is no longer within their "grace period", you may use the <code class=" language-php">ended</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">ended</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p><a name="incomplete-and-past-due-status"></a></p>
<h4><a href="#incomplete-and-past-due-status">Incomplete and Past Due Status</a></h4>
<p>If a subscription requires a secondary payment action after creation the subscription will be marked as <code class=" language-php">incomplete</code>. Subscription statuses are stored in the <code class=" language-php">stripe_status</code> column of Cashier's <code class=" language-php">subscriptions</code> database table.</p>
<p>Similarly, if a secondary payment action is required when swapping plans the subscription will be marked as <code class=" language-php">past_due</code>. When your subscription is in either of these states it will not be active until the customer has confirmed their payment. Checking if a subscription has an incomplete payment can be done using the <code class=" language-php">hasIncompletePayment</code> method on the Billable model or a subscription instance:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hasIncompletePayment</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hasIncompletePayment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p>When a subscription has an incomplete payment, you should direct the user to Cashier's payment confirmation page, passing the <code class=" language-php">latestPayment</code> identifier. You may use the <code class=" language-php">latestPayment</code> method available on subscription instance to retrieve this identifier:</p>
<pre class=" language-php"><code class=" language-php"><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token double-quoted-string string">"{{ route('cashier.payment', <span class="token interpolation"><span class="token variable">$subscription</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">latestPayment</span></span>()-&gt;id) }}"</span><span class="token operator">&gt;</span>
    Please confirm your payment<span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span></code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> When a subscription is in an <code class=" language-php">incomplete</code> state it cannot be changed until the payment is confirmed. Therefore, the <code class=" language-php">swap</code> and <code class=" language-php">updateQuantity</code> methods will throw an exception when the subscription is in an <code class=" language-php">incomplete</code> state.</p></div>
</blockquote>
<p><a name="changing-plans"></a></p>
<h3><a href="#changing-plans">Changing Plans</a></h3>
<p>After a user is subscribed to your application, they may occasionally want to change to a new subscription plan. To swap a user to a new subscription, pass the plan's identifier to the <code class=" language-php">swap</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span class="token operator">=</span> App\<span class="token package">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'provider-plan-id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>If the user is on trial, the trial period will be maintained. Also, if a "quantity" exists for the subscription, that quantity will also be maintained.</p>
<p>If you would like to swap plans and cancel any trial period the user is currently on, you may use the <code class=" language-php">skipTrial</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">skipTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'provider-plan-id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>If you would like to swap plans and immediately invoice the user instead of waiting for their next billing cycle, you may use the <code class=" language-php">swapAndInvoice</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span class="token operator">=</span> App\<span class="token package">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">swapAndInvoice</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'provider-plan-id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="subscription-quantity"></a></p>
<h3><a href="#subscription-quantity">Subscription Quantity</a></h3>
<p>Sometimes subscriptions are affected by "quantity". For example, your application might charge $10 per month <strong>per user</strong> on an account. To easily increment or decrement your subscription quantity, use the <code class=" language-php">incrementQuantity</code> and <code class=" language-php">decrementQuantity</code> methods:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add five to the subscription's current quantity...</span>
<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">incrementQuantity</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">decrementQuantity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Subtract five to the subscription's current quantity...</span>
<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">decrementQuantity</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Alternatively, you may set a specific quantity using the <code class=" language-php">updateQuantity</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">updateQuantity</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The <code class=" language-php">noProrate</code> method may be used to update the subscription's quantity without pro-rating the charges:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">noProrate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">updateQuantity</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>For more information on subscription quantities, consult the <a href="https://stripe.com/docs/subscriptions/quantities">Stripe documentation</a>.</p>
<p><a name="subscription-taxes"></a></p>
<h3><a href="#subscription-taxes">Subscription Taxes</a></h3>
<p>To specify the tax percentage a user pays on a subscription, implement the <code class=" language-php">taxPercentage</code> method on your billable model, and return a numeric value between 0 and 100, with no more than 2 decimal places.</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">taxPercentage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The <code class=" language-php">taxPercentage</code> method enables you to apply a tax rate on a model-by-model basis, which may be helpful for a user base that spans multiple countries and tax rates.</p>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> The <code class=" language-php">taxPercentage</code> method only applies to subscription charges. If you use Cashier to make "one off" charges, you will need to manually specify the tax rate at that time.</p></div>
</blockquote>
<h4>Syncing Tax Percentages</h4>
<p>When changing the hard-coded value returned by the <code class=" language-php">taxPercentage</code> method, the tax settings on any existing subscriptions for the user will remain the same. If you wish to update the tax value for existing subscriptions with the returned <code class=" language-php">taxPercentage</code> value, you should call the <code class=" language-php">syncTaxPercentage</code> method on the user's subscription instance:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">syncTaxPercentage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="subscription-anchor-date"></a></p>
<h3><a href="#subscription-anchor-date">Subscription Anchor Date</a></h3>
<p>By default, the billing cycle anchor is the date the subscription was created, or if a trial period is used, the date that the trial ends. If you would like to modify the billing anchor date, you may use the <code class=" language-php">anchorBillingCycleOn</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Carbon<span class="token punctuation">\</span>Carbon</span><span class="token punctuation">;</span>

<span class="token variable">$user</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$anchor</span> <span class="token operator">=</span> Carbon<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'first day of next month'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">newSubscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'premium'</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">anchorBillingCycleOn</span><span class="token punctuation">(</span><span class="token variable">$anchor</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">startOfDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>For more information on managing subscription billing cycles, consult the <a href="https://stripe.com/docs/billing/subscriptions/billing-cycle">Stripe billing cycle documentation</a></p>
<p><a name="cancelling-subscriptions"></a></p>
<h3><a href="#cancelling-subscriptions">Cancelling Subscriptions</a></h3>
<p>To cancel a subscription, call the <code class=" language-php">cancel</code> method on the user's subscription:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>When a subscription is cancelled, Cashier will automatically set the <code class=" language-php">ends_at</code> column in your database. This column is used to know when the <code class=" language-php">subscribed</code> method should begin returning <code class=" language-php"><span class="token boolean constant">false</span></code>. For example, if a customer cancels a subscription on March 1st, but the subscription was not scheduled to end until March 5th, the <code class=" language-php">subscribed</code> method will continue to return <code class=" language-php"><span class="token boolean constant">true</span></code> until March 5th.</p>
<p>You may determine if a user has cancelled their subscription but are still on their "grace period" using the <code class=" language-php">onGracePeriod</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onGracePeriod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p>If you wish to cancel a subscription immediately, call the <code class=" language-php">cancelNow</code> method on the user's subscription:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">cancelNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="resuming-subscriptions"></a></p>
<h3><a href="#resuming-subscriptions">Resuming Subscriptions</a></h3>
<p>If a user has cancelled their subscription and you wish to resume it, use the <code class=" language-php">resume</code> method. The user <strong>must</strong> still be on their grace period in order to resume a subscription:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>If the user cancels a subscription and then resumes that subscription before the subscription has fully expired, they will not be billed immediately. Instead, their subscription will be re-activated, and they will be billed on the original billing cycle.</p>
<p><a name="subscription-trials"></a></p>
<h2><a href="#subscription-trials">Subscription Trials</a></h2>
<p><a name="with-payment-method-up-front"></a></p>
<h3><a href="#with-payment-method-up-front">With Payment Method Up Front</a></h3>
<p>If you would like to offer trial periods to your customers while still collecting payment method information up front, you should use the <code class=" language-php">trialDays</code> method when creating your subscriptions:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">newSubscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'monthly'</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">trialDays</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>This method will set the trial period ending date on the subscription record within the database, as well as instruct Stripe to not begin billing the customer until after this date. When using the <code class=" language-php">trialDays</code> method, Cashier will overwrite any default trial period configured for the plan in Stripe.</p>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> If the customer's subscription is not cancelled before the trial ending date they will be charged as soon as the trial expires, so you should be sure to notify your users of their trial ending date.</p></div>
</blockquote>
<p>The <code class=" language-php">trialUntil</code> method allows you to provide a <code class=" language-php">DateTime</code> instance to specify when the trial period should end:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">use</span> <span class="token package">Carbon<span class="token punctuation">\</span>Carbon</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">newSubscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'monthly'</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">trialUntil</span><span class="token punctuation">(</span>Carbon<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">addDays</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>You may determine if the user is within their trial period using either the <code class=" language-php">onTrial</code> method of the user instance, or the <code class=" language-php">onTrial</code> method of the subscription instance. The two examples below are identical:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onTrial</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p><a name="without-payment-method-up-front"></a></p>
<h3><a href="#without-payment-method-up-front">Without Payment Method Up Front</a></h3>
<p>If you would like to offer trial periods without collecting the user's payment method information up front, you may set the <code class=" language-php">trial_ends_at</code> column on the user record to your desired trial ending date. This is typically done during user registration:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token comment">// Populate other user properties...</span>
    <span class="token single-quoted-string string">'trial_ends_at'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">addDays</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> Be sure to add a <a href="#date-mutators">date mutator</a> for <code class=" language-php">trial_ends_at</code> to your model definition.</p></div>
</blockquote>
<p>Cashier refers to this type of trial as a "generic trial", since it is not attached to any existing subscription. The <code class=" language-php">onTrial</code> method on the <code class=" language-php">User</code> instance will return <code class=" language-php"><span class="token boolean constant">true</span></code> if the current date is not past the value of <code class=" language-php">trial_ends_at</code>:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// User is within their trial period...</span>
<span class="token punctuation">}</span></code></pre>
<p>You may also use the <code class=" language-php">onGenericTrial</code> method if you wish to know specifically that the user is within their "generic" trial period and has not created an actual subscription yet:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onGenericTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// User is within their "generic" trial period...</span>
<span class="token punctuation">}</span></code></pre>
<p>Once you are ready to create an actual subscription for the user, you may use the <code class=" language-php">newSubscription</code> method as usual:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">newSubscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'main'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'monthly'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="handling-stripe-webhooks"></a></p>
<h2><a href="#handling-stripe-webhooks">Handling Stripe Webhooks</a></h2>
<blockquote>
<div class="callout"><div class="icon purple"><img src="./01-Cashier_files/lightbulb.min.svg"></div><p class="content"> You may use <a href="https://laravel.com/docs/6.0/valet">Laravel Valet's</a> <code class=" language-php">valet share</code> command to help test webhooks during local development.</p></div>
</blockquote>
<p>Stripe can notify your application of a variety of events via webhooks. By default, a route that points to Cashier's webhook controller is configured through the Cashier service provider. This controller will handle all incoming webhook requests.</p>
<p>By default, this controller will automatically handle cancelling subscriptions that have too many failed charges (as defined by your Stripe settings), customer updates, customer deletions, subscription updates, and payment method changes; however, as we'll soon discover, you can extend this controller to handle any webhook event you like.</p>
<p>To ensure your application can handle Stripe webhooks, be sure to configure the webhook URL in the Stripe control panel. The full list of all webhooks you should configure in the Stripe control panel are:</p>
<ul>
<li><code class=" language-php">customer<span class="token punctuation">.</span>subscription<span class="token punctuation">.</span>updated</code></li>
<li><code class=" language-php">customer<span class="token punctuation">.</span>subscription<span class="token punctuation">.</span>deleted</code></li>
<li><code class=" language-php">customer<span class="token punctuation">.</span>updated</code></li>
<li><code class=" language-php">customer<span class="token punctuation">.</span>deleted</code></li>
<li><code class=" language-php">invoice<span class="token punctuation">.</span>payment_action_required</code></li>
</ul>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> Make sure you protect incoming requests with Cashier's included <a href="#verifying-webhook-signatures">webhook signature verification</a> middleware.</p></div>
</blockquote>
<h4>Webhooks &amp; CSRF Protection</h4>
<p>Since Stripe webhooks need to bypass Laravel's <a href="https://laravel.com/docs/6.0/csrf">CSRF protection</a>, be sure to list the URI as an exception in your <code class=" language-php">VerifyCsrfToken</code> middleware or list the route outside of the <code class=" language-php">web</code> middleware group:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">protected</span> <span class="token variable">$except</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'stripe/*'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<p><a name="defining-webhook-event-handlers"></a></p>
<h3><a href="#defining-webhook-event-handlers">Defining Webhook Event Handlers</a></h3>
<p>Cashier automatically handles subscription cancellation on failed charges, but if you have additional webhook events you would like to handle, extend the Webhook controller. Your method names should correspond to Cashier's expected convention, specifically, methods should be prefixed with <code class=" language-php">handle</code> and the "camel case" name of the webhook you wish to handle. For example, if you wish to handle the <code class=" language-php">invoice<span class="token punctuation">.</span>payment_succeeded</code> webhook, you should add a <code class=" language-php">handleInvoicePaymentSucceeded</code> method to the controller:</p>
<pre class=" language-php"><code class=" language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Cashier<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers<span class="token punctuation">\</span>WebhookController</span> <span class="token keyword">as</span> CashierController<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">WebhookController</span> <span class="token keyword">extends</span> <span class="token class-name">CashierController</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Handle invoice payment succeeded.
     *
     * @param  array  $payload
     * @return \Symfony\Component\HttpFoundation\Response
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handleInvoicePaymentSucceeded</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Handle The Event</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
<p>Next, define a route to your Cashier controller within your <code class=" language-php">routes<span class="token operator">/</span>web<span class="token punctuation">.</span>php</code> file. This will overwrite the default shipped route:</p>
<pre class=" language-php"><code class=" language-php">Route<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">post</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'stripe/webhook'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'\App\Http\Controllers\WebhookController@handleWebhook'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="handling-failed-subscriptions"></a></p>
<h3><a href="#handling-failed-subscriptions">Failed Subscriptions</a></h3>
<p>What if a customer's credit card expires? No worries - Cashier's Webhook controller will cancel the customer's subscription for you. Failed payments will automatically be captured and handled by the controller. The controller will cancel the customer's subscription when Stripe determines the subscription has failed (normally after three failed payment attempts).</p>
<p><a name="verifying-webhook-signatures"></a></p>
<h3><a href="#verifying-webhook-signatures">Verifying Webhook Signatures</a></h3>
<p>To secure your webhooks, you may use <a href="https://stripe.com/docs/webhooks/signatures">Stripe's webhook signatures</a>. For convenience, Cashier automatically includes a middleware which validates that the incoming Stripe webhook request is valid.</p>
<p>To enable webhook verification, ensure that the <code class=" language-php"><span class="token constant">STRIPE_WEBHOOK_SECRET</span></code> environment variable is set in your <code class=" language-php"><span class="token punctuation">.</span>env</code> file. The webhook <code class=" language-php">secret</code> may be retrieved from your Stripe account dashboard.</p>
<p><a name="single-charges"></a></p>
<h2><a href="#single-charges">Single Charges</a></h2>
<p><a name="simple-charge"></a></p>
<h3><a href="#simple-charge">Simple Charge</a></h3>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> The <code class=" language-php">charge</code> method accepts the amount you would like to charge in the <strong>lowest denominator of the currency used by your application</strong>.</p></div>
</blockquote>
<p>If you would like to make a "one off" charge against a subscribed customer's payment method, you may use the <code class=" language-php">charge</code> method on a billable model instance. You'll need to <a href="#storing-payment-methods">provide a payment method identifier</a> as the second argument:</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment">// Stripe Accepts Charges In Cents...</span>
<span class="token variable">$stripeCharge</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">charge</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The <code class=" language-php">charge</code> method accepts an array as its third argument, allowing you to pass any options you wish to the underlying Stripe charge creation. Consult the Stripe documentation regarding the options available to you when creating charges:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">charge</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token variable">$paymentMethod</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'custom_option'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$value</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The <code class=" language-php">charge</code> method will throw an exception if the charge fails. If the charge is successful, an instance of <code class=" language-php">Laravel\<span class="token package">Cashier<span class="token punctuation">\</span>Payment</span></code> will be returned from the method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token variable">$payment</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">charge</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>Exception <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
<p><a name="charge-with-invoice"></a></p>
<h3><a href="#charge-with-invoice">Charge With Invoice</a></h3>
<p>Sometimes you may need to make a one-time charge but also generate an invoice for the charge so that you may offer a PDF receipt to your customer. The <code class=" language-php">invoiceFor</code> method lets you do just that. For example, let's invoice the customer $5.00 for a "One Time Fee":</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment">// Stripe Accepts Charges In Cents...</span>
<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">invoiceFor</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'One Time Fee'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The invoice will be charged immediately against the user's default payment method. The <code class=" language-php">invoiceFor</code> method also accepts an array as its third argument. This array contains the billing options for the invoice item. The fourth argument accepted by the method is also an array. This final argument accepts the billing options for the invoice itself:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">invoiceFor</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Stickers'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'quantity'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'tax_percent'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">21</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> The <code class=" language-php">invoiceFor</code> method will create a Stripe invoice which will retry failed billing attempts. If you do not want invoices to retry failed charges, you will need to close them using the Stripe API after the first failed charge.</p></div>
</blockquote>
<p><a name="refunding-charges"></a></p>
<h3><a href="#refunding-charges">Refunding Charges</a></h3>
<p>If you need to refund a Stripe charge, you may use the <code class=" language-php">refund</code> method. This method accepts the Stripe Payment Intent ID as its first argument:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$payment</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">charge</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">refund</span><span class="token punctuation">(</span><span class="token variable">$payment</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="invoices"></a></p>
<h2><a href="#invoices">Invoices</a></h2>
<p>You may easily retrieve an array of a billable model's invoices using the <code class=" language-php">invoices</code> method:</p>
<pre class=" language-php"><code class=" language-php"><span class="token variable">$invoices</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">invoices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Include pending invoices in the results...</span>
<span class="token variable">$invoices</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">invoicesIncludingPending</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>When listing the invoices for the customer, you may use the invoice's helper methods to display the relevant invoice information. For example, you may wish to list every invoice in a table, allowing the user to easily download any of them:</p>
<pre class=" language-php"><code class=" language-php"><span class="token operator">&lt;</span>table<span class="token operator">&gt;</span>
    @<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$invoices</span> <span class="token keyword">as</span> <span class="token variable">$invoice</span><span class="token punctuation">)</span>
        <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token variable">$invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">toFormattedDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token variable">$invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">total</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token double-quoted-string string">"/user/invoice/{{ <span class="token interpolation"><span class="token variable">$invoice</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span></span> }}"</span><span class="token operator">&gt;</span>Download<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
    @<span class="token keyword">endforeach</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span></code></pre>
<p><a name="generating-invoice-pdfs"></a></p>
<h3><a href="#generating-invoice-pdfs">Generating Invoice PDFs</a></h3>
<p>From within a route or controller, use the <code class=" language-php">downloadInvoice</code> method to generate a PDF download of the invoice. This method will automatically generate the proper HTTP response to send the download to the browser:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>

Route<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user/invoice/{invoice}'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$invoiceId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">downloadInvoice</span><span class="token punctuation">(</span><span class="token variable">$invoiceId</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'vendor'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Your Company'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'product'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Your Product'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="strong-customer-authentication"></a></p>
<h2><a href="#strong-customer-authentication">Strong Customer Authentication</a></h2>
<p>If your business is based in Europe you will need to abide by the Strong Customer Authentication (SCA) regulations. These regulations were imposed&nbsp;in September 2019 by the European Union to prevent payment fraud. Luckily, Stripe and Cashier are prepared for building SCA compliant applications.</p>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> Before getting started, review <a href="https://stripe.com/en-be/guides/strong-customer-authentication">Stripe's guide on PSD2 and SCA</a> as well as their <a href="https://stripe.com/docs/strong-customer-authentication">documentation on the new SCA API's</a>.</p></div>
</blockquote>
<p><a name="payments-requiring-additional-confirmation"></a></p>
<h3><a href="#payments-requiring-additional-confirmation">Payments Requiring Additional Confirmation</a></h3>
<p>SCA regulations often require extra verification in order to confirm and process a payment. When this happens, Cashier will throw an <code class=" language-php">IncompletePayment</code> exception that informs you that this extra verification is needed. After catching this exception, you have two options on how to proceed.</p>
<p>First, you could redirect your customer to the dedicated payment confirmation page which is included with Cashier. This page already has an associated route that is registered via Cashier's service provider. So, you may catch the <code class=" language-php">IncompletePayment</code> exception and redirect to the payment confirmation page:</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Cashier<span class="token punctuation">\</span>Exceptions<span class="token punctuation">\</span>IncompletePayment</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token variable">$subscription</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">newSubscription</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'default'</span><span class="token punctuation">,</span> <span class="token variable">$planId</span><span class="token punctuation">)</span>
                            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$paymentMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>IncompletePayment <span class="token variable">$exception</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">route</span><span class="token punctuation">(</span>
        <span class="token single-quoted-string string">'cashier.payment'</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token variable">$exception</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">payment</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'redirect'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'home'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>On the payment confirmation page, the customer will be prompted to enter their credit card info again and perform any additional actions required by Stripe, such as "3D Secure" confirmation. After confirming their payment, the user will be redirected to the URL provided by the <code class=" language-php">redirect</code> parameter specified above.</p>
<p>Alternatively, you could allow Stripe to handle the payment confirmation for you. In this case, instead of redirecting to the payment confirmation page, you may <a href="https://dashboard.stripe.com/account/billing/automatic">setup Stripe's automatic billing emails</a> in your Stripe dashboard. However, if an <code class=" language-php">IncompletePayment</code> exception is caught, you should still inform the user they will receive an email with further payment confirmation instructions.</p>
<p>Incomplete payment exceptions may be thrown for the following methods: <code class=" language-php">charge</code>, <code class=" language-php">invoiceFor</code>, and <code class=" language-php">invoice</code> on the <code class=" language-php">Billable</code> user. When handling subscriptions, the <code class=" language-php">create</code> method on the <code class=" language-php">SubscriptionBuilder</code>, and the <code class=" language-php">incrementAndInvoice</code> and <code class=" language-php">swapAndInvoice</code> methods on the <code class=" language-php">Susbcription</code> model may throw exceptions.</p>
<h4>Incomplete and Past Due State</h4>
<p>When a payment needs additional confirmation, the subscription will remain in an <code class=" language-php">incomplete</code> or <code class=" language-php">past_due</code> state as indicated by its <code class=" language-php">stripe_status</code> database column. Cashier will make automatically activate the customer's subscription via a webhook as soon as payment confirmation is complete.</p>
<p>For more information on <code class=" language-php">incomplete</code> and <code class=" language-php">past_due</code> states, please refer to <a href="#incomplete-and-past-due-status">our additional documentation</a>.</p>
<p><a name="off-session-payment-notifications"></a></p>
<h3><a href="#off-session-payment-notifications">Off-Session Payment Notifications</a></h3>
<p>Since SCA regulations require customers to occasionally verify their payment details even while their subscription is active, Cashier can send a payment notification to the customer when off-session payment confirmation is required. For example, this may occur when a subscription is renewing. Cashier's payment notification can be enabled by setting the <code class=" language-php"><span class="token constant">CASHIER_PAYMENT_NOTIFICATION</span></code> environment variable to a notification class. By default, this notification is disabled. Of course, Cashier includes a notification class you may use for this purpose, but you are free to provide your own notification class if desired:</p>
<pre class=" language-php"><code class=" language-php"><span class="token constant">CASHIER_PAYMENT_NOTIFICATION</span><span class="token operator">=</span>Laravel\<span class="token package">Cashier<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>ConfirmPayment</span></code></pre>
<p>To ensure that off-session payment confirmation notifications are delivered, verify that <a href="#handling-stripe-webhooks">Stripe webhooks are configured</a> for your application and the <code class=" language-php">invoice<span class="token punctuation">.</span>payment_action_required</code> webhook is enabled in your Stripe dashboard. In addition, your <code class=" language-php">Billable</code> model should also use Laravel's <code class=" language-php">Illuminate\<span class="token package">Notifications<span class="token punctuation">\</span>Notifiable</span></code> trait.</p>
<blockquote>
<div class="callout"><div class="icon red"><img src="./01-Cashier_files/exclamation.min.svg"></div><p class="content"> Notifications will be sent even when customers are manually making a payment that requires additional confirmation. Unfortunately, there is no way for Stripe to know that the payment was done manually or "off-session". But, a customer will simply see a "Payment Successful" message if they visit the payment page after already confirming their payment. The customer will not be allowed to accidentally confirm the same payment twice and incur an accidental second charge.</p></div>
</blockquote>
                        </section>
                    </section>
                </section>
            </div>
        </div>

    </div>


<script src="./01-Cashier_files/app.js.download"></script>



</body></html>